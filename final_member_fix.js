const { createClient } = require('@supabase/supabase-js');
const XLSX = require('xlsx');

// Supabase configuration - using service role key to bypass RLS
const supabaseUrl = 'https://zdnyhzasvifrskbostgn.supabase.co';
const supabaseServiceKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpkbnloemFzdmlmcnNrYm9zdGduIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1ODAyNDQ4NCwiZXhwIjoyMDczNjAwNDg0fQ.8vJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8vQJ8v
